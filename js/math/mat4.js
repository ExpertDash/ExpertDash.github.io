export class Matrix4x4 {
    constructor(...value) {
        this.value = value;
    }
    static get identity() { return identity; }
    static get zero() { return zero; }
    getRow(i) {
        return [this.value[4 * i], this.value[4 * i + 1], this.value[4 * i + 2], this.value[4 * i + 3]];
    }
    getColumn(j) {
        return [this.value[j], this.value[4 + j], this.value[8 + j], this.value[12 + j]];
    }
    mul(other) {
        const [m, n] = [4, 4];
        let value = new Array(m * n);
        for (let i = m - 1; i >= 0; i--)
            for (let j = n - 1; j >= 0; j--)
                value[4 * i + j] = Matrix4x4.dot4(this.getRow(i), other.getColumn(j));
        return new Matrix4x4(...value);
    }
    mulVec(vec) {
        return [
            Matrix4x4.dot4(this.getRow(0), vec),
            Matrix4x4.dot4(this.getRow(1), vec),
            Matrix4x4.dot4(this.getRow(2), vec),
            Matrix4x4.dot4(this.getRow(3), vec)
        ];
    }
    transpose() {
        return new Matrix4x4(...this.getColumn(0), ...this.getColumn(1), ...this.getColumn(2), ...this.getColumn(3));
    }
    toString() {
        return `[[${this.getRow(0)}],[${this.getRow(1)}],[${this.getRow(2)}],[${this.getRow(3)}]]`;
    }
    [Symbol.iterator]() {
        return this.value.values();
    }
    /**
     * @param fov Field of view in radians
     * @param aspect Aspect ratio
     * @param near Near clipping field
     * @param far Far clipping field
     */
    static createPerspective(fov, aspect, near, far) {
        const a = 1 / Math.tan(fov / 2);
        const b = 1 / (near - far);
        return new Matrix4x4(a / aspect, 0, 0, 0, 0, a, 0, 0, 0, 0, (far + near) * b, 2 * far * near * b, 0, 0, -1, 0);
    }
    /**
     * @param width Width
     * @param height Height
     * @param near Near clipping field
     * @param far Far clipping field
     */
    static createOrtho(width, height, near, far) {
        let [l, r] = [-width / 2, width / 2];
        let [t, b] = [height / 2, -height / 2];
        return new Matrix4x4(2 / (r - l), 0, 0, -(r + l) / (r - l), 0, 2 / (t - b), 0, -(t + b) / (t - b), 0, 0, -2 / (far - near), -(far + near) / (far - near), 0, 0, 0, 1);
    }
    /**
     * @param p Global position
     * @param r Global rotation
     * @param s Global scale
     * @return Translation, rotation, scale matrix
     */
    static trs(p, r, s) {
        return new Matrix4x4(1, 0, 0, p.x, 0, 1, 0, p.y, 0, 0, 1, p.z, 0, 0, 0, 1).mul(new Matrix4x4(Math.cos(r), -Math.sin(r), 0, 0, Math.sin(r), Math.cos(r), 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)).mul(new Matrix4x4(s.x, 0, 0, 0, 0, s.y, 0, 0, 0, 0, s.z, 0, 0, 0, 0, 1));
    }
    static dot4(lhs, rhs) {
        return lhs[0] * rhs[0] + lhs[1] * rhs[1] + lhs[2] * rhs[2] + lhs[3] * rhs[3];
    }
}
const identity = Object.freeze(mat4(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1));
const zero = Object.freeze(mat4(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0));
export function mat4(...value) {
    return new Matrix4x4(...value);
}
export default Matrix4x4;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0NC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tYXRoL21hdDQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsTUFBTSxPQUFPLFNBQVM7SUFHckIsWUFBbUIsR0FBRyxLQUFlO1FBQ3BDLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFBO0lBQ25CLENBQUM7SUFFTSxNQUFNLEtBQUssUUFBUSxLQUEwQixPQUFPLFFBQVEsQ0FBQSxDQUFDLENBQUM7SUFDOUQsTUFBTSxLQUFLLElBQUksS0FBMEIsT0FBTyxJQUFJLENBQUEsQ0FBQyxDQUFDO0lBRXRELE1BQU0sQ0FBQyxDQUFTO1FBQ3RCLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQ2hHLENBQUM7SUFFTSxTQUFTLENBQUMsQ0FBUztRQUN6QixPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQ2pGLENBQUM7SUFFTSxHQUFHLENBQUMsS0FBZ0I7UUFDMUIsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQTtRQUNyQixJQUFJLEtBQUssR0FBRyxJQUFJ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QUFFLENBQUMsQ0FDVixDQUFDLEdBQUcsQ0FBQyxJQUFJLFNBQVMsQ0FDbEIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFDL0IsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQzlCLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFDVixDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQ1YsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLFNBQVMsQ0FDbkIsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFDWixDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUNaLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQ1osQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUNWLENBQUMsQ0FBQTtJQUNILENBQUM7SUFFTyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQXFDLEVBQUUsR0FBcUM7UUFDL0YsT0FBTyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQzdFLENBQUM7Q0FDRDtBQUVELE1BQU0sUUFBUSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUNsQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQ1YsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUNWLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFDVixDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQ1YsQ0FBQyxDQUFBO0FBRUYsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQzlCLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFDVixDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQ1YsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUNWLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FDVixDQUFDLENBQUE7QUFFRixNQUFNLFVBQVUsSUFBSSxDQUFDLEdBQUcsS0FBZTtJQUN0QyxPQUFPLElBQUksU0FBUyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUE7QUFDL0IsQ0FBQztBQUVELGVBQWUsU0FBUyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFZlY3RvcjMgZnJvbSBcIi4vdmVjMy5qc1wiXHJcbnR5cGUgVmVjdG9yID0gW251bWJlciwgbnVtYmVyLCBudW1iZXIsIG51bWJlcl1cclxuXHJcbmV4cG9ydCBjbGFzcyBNYXRyaXg0eDQge1xyXG5cdHByaXZhdGUgcmVhZG9ubHkgdmFsdWU6IG51bWJlcltdXHJcblxyXG5cdHB1YmxpYyBjb25zdHJ1Y3RvciguLi52YWx1ZTogbnVtYmVyW10pIHtcclxuXHRcdHRoaXMudmFsdWUgPSB2YWx1ZVxyXG5cdH1cclxuXHJcblx0cHVibGljIHN0YXRpYyBnZXQgaWRlbnRpdHkoKTogUmVhZG9ubHk8TWF0cml4NHg0PiB7IHJldHVybiBpZGVudGl0eSB9XHJcblx0cHVibGljIHN0YXRpYyBnZXQgemVybygpOiBSZWFkb25seTxNYXRyaXg0eDQ+IHsgcmV0dXJuIHplcm8gfVxyXG5cclxuXHRwdWJsaWMgZ2V0Um93KGk6IG51bWJlcik6IFZlY3RvciB7XHJcblx0XHRyZXR1cm4gW3RoaXMudmFsdWVbNCAqIGldLCB0aGlzLnZhbHVlWzQgKiBpICsgMV0sIHRoaXMudmFsdWVbNCAqIGkgKyAyXSwgdGhpcy52YWx1ZVs0ICogaSArIDNdXVxyXG5cdH1cclxuXHJcblx0cHVibGljIGdldENvbHVtbihqOiBudW1iZXIpOiBWZWN0b3Ige1xyXG5cdFx0cmV0dXJuIFt0aGlzLnZhbHVlW2pdLCB0aGlzLnZhbHVlWzQgKyBqXSwgdGhpcy52YWx1ZVs4ICsgal0sIHRoaXMudmFsdWVbMTIgKyBqXV1cclxuXHR9XHJcblxyXG5cdHB1YmxpYyBtdWwob3RoZXI6IE1hdHJpeDR4NCk6IE1hdHJpeDR4NCB7XHJcblx0XHRjb25zdCBbbSwgbl0gPSBbNCwgNF1cclxuXHRcdGxldCB2YWx1ZSA9IG5ldyBBcnJheTxudW1iZXI+KG0gKiBuKVxyXG5cclxuXHRcdGZvcihsZXQgaSA9IG0gLSAxOyBpID49IDA7IGktLSlcclxuXHRcdFx0Zm9yKGxldCBqID0gbiAtIDE7IGogPj0gMDsgai0tKVxyXG5cdFx0XHRcdHZhbHVlWzQgKiBpICsgal0gPSBNYXRyaXg0eDQuZG90NCh0aGlzLmdldFJvdyhpKSwgb3RoZXIuZ2V0Q29sdW1uKGopKVxyXG5cclxuXHRcdHJldHVybiBuZXcgTWF0cml4NHg0KC4uLnZhbHVlKVxyXG5cdH1cclxuXHJcblx0cHVibGljIG11bFZlYyh2ZWM6IFZlY3Rvcik6IFZlY3RvciB7XHJcblx0XHRyZXR1cm4gW1xyXG5cdFx0XHRNYXRyaXg0eDQuZG90NCh0aGlzLmdldFJvdygwKSwgdmVjKSxcclxuXHRcdFx0TWF0cml4NHg0LmRvdDQodGhpcy5nZXRSb3coMSksIHZlYyksXHJcblx0XHRcdE1hdHJpeDR4NC5kb3Q0KHRoaXMuZ2V0Um93KDIpLCB2ZWMpLFxyXG5cdFx0XHRNYXRyaXg0eDQuZG90NCh0aGlzLmdldFJvdygzKSwgdmVjKVxyXG5cdFx0XVxyXG5cdH1cclxuXHJcblx0cHVibGljIHRyYW5zcG9zZSgpOiBNYXRyaXg0eDQge1xyXG5cdFx0cmV0dXJuIG5ldyBNYXRyaXg0eDQoXHJcblx0XHRcdC4uLnRoaXMuZ2V0Q29sdW1uKDApLFxyXG5cdFx0XHQuLi50aGlzLmdldENvbHVtbigxKSxcclxuXHRcdFx0Li4udGhpcy5nZXRDb2x1bW4oMiksXHJcblx0XHRcdC4uLnRoaXMuZ2V0Q29sdW1uKDMpXHJcblx0XHQpXHJcblx0fVxyXG5cclxuXHRwdWJsaWMgdG9TdHJpbmcoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBgW1ske3RoaXMuZ2V0Um93KDApfV0sWyR7dGhpcy5nZXRSb3coMSl9XSxbJHt0aGlzLmdldFJvdygyKX1dLFske3RoaXMuZ2V0Um93KDMpfV1dYFxyXG5cdH1cclxuXHJcblx0cHVibGljIFtTeW1ib2wuaXRlcmF0b3JdKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMudmFsdWUudmFsdWVzKClcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSBmb3YgRmllbGQgb2YgdmlldyBpbiByYWRpYW5zXHJcblx0ICogQHBhcmFtIGFzcGVjdCBBc3BlY3QgcmF0aW9cclxuXHQgKiBAcGFyYW0gbmVhciBOZWFyIGNsaXBwaW5nIGZpZWxkXHJcblx0ICogQHBhcmFtIGZhciBGYXIgY2xpcHBpbmcgZmllbGRcclxuXHQgKi9cclxuXHRwdWJsaWMgc3RhdGljIGNyZWF0ZVBlcnNwZWN0aXZlKGZvdjogbnVtYmVyLCBhc3BlY3Q6IG51bWJlciwgbmVhcjogbnVtYmVyLCBmYXI6IG51bWJlcikge1xyXG5cdFx0Y29uc3QgYSA9IDEgLyBNYXRoLnRhbihmb3YgLyAyKVxyXG5cdFx0Y29uc3QgYiA9IDEgLyAobmVhciAtIGZhcilcclxuXHJcblx0XHRyZXR1cm4gbmV3IE1hdHJpeDR4NChcclxuXHRcdFx0YSAvIGFzcGVjdCwgMCwgMCwgMCxcclxuXHRcdFx0MCwgYSwgMCwgMCxcclxuXHRcdFx0MCwgMCwgKGZhciArIG5lYXIpICogYiwgMiAqIGZhciAqIG5lYXIgKiBiLFxyXG5cdFx0XHQwLCAwLCAtMSwgMFxyXG5cdFx0KVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHdpZHRoIFdpZHRoXHJcblx0ICogQHBhcmFtIGhlaWdodCBIZWlnaHRcclxuXHQgKiBAcGFyYW0gbmVhciBOZWFyIGNsaXBwaW5nIGZpZWxkXHJcblx0ICogQHBhcmFtIGZhciBGYXIgY2xpcHBpbmcgZmllbGRcclxuXHQgKi9cclxuXHRwdWJsaWMgc3RhdGljIGNyZWF0ZU9ydGhvKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyLCBuZWFyOiBudW1iZXIsIGZhcjogbnVtYmVyKSB7XHJcblx0XHRsZXQgW2wsIHJdID0gWy13aWR0aCAvIDIsIHdpZHRoIC8gMl1cclxuXHRcdGxldCBbdCwgYl0gPSBbaGVpZ2h0IC8gMiwgLWhlaWdodCAvIDJdXHJcblxyXG5cdFx0cmV0dXJuIG5ldyBNYXRyaXg0eDQoXHJcblx0XHRcdDIgLyAociAtIGwpLCAwLCAwLCAtKHIgKyBsKSAvIChyIC0gbCksXHJcblx0XHRcdDAsIDIgLyAodCAtIGIpLCAwLCAtKHQgKyBiKSAvICh0IC0gYiksXHJcblx0XHRcdDAsIDAsIC0yIC8gKGZhciAtIG5lYXIpLCAtKGZhciArIG5lYXIpIC8gKGZhciAtIG5lYXIpLFxyXG5cdFx0XHQwLCAwLCAwLCAxXHJcblx0XHQpXHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0gcCBHbG9iYWwgcG9zaXRpb25cclxuXHQgKiBAcGFyYW0gciBHbG9iYWwgcm90YXRpb25cclxuXHQgKiBAcGFyYW0gcyBHbG9iYWwgc2NhbGVcclxuXHQgKiBAcmV0dXJuIFRyYW5zbGF0aW9uLCByb3RhdGlvbiwgc2NhbGUgbWF0cml4XHJcblx0ICovXHJcblx0cHVibGljIHN0YXRpYyB0cnMocDogVmVjdG9yMywgcjogbnVtYmVyLCBzOiBWZWN0b3IzKTogTWF0cml4NHg0IHtcclxuXHRcdHJldHVybiBuZXcgTWF0cml4NHg0KFxyXG5cdFx0XHQxLCAwLCAwLCBwLngsXHJcblx0XHRcdDAsIDEsIDAsIHAueSxcclxuXHRcdFx0MCwgMCwgMSwgcC56LFxyXG5cdFx0XHQwLCAwLCAwLCAxXHJcblx0XHQpLm11bChuZXcgTWF0cml4NHg0KFxyXG5cdFx0XHRNYXRoLmNvcyhyKSwgLU1hdGguc2luKHIpLCAwLCAwLFxyXG5cdFx0XHRNYXRoLnNpbihyKSwgTWF0aC5jb3MociksIDAsIDAsXHJcblx0XHRcdDAsIDAsIDEsIDAsXHJcblx0XHRcdDAsIDAsIDAsIDFcclxuXHRcdCkpLm11bChuZXcgTWF0cml4NHg0KFxyXG5cdFx0XHRzLngsIDAsIDAsIDAsXHJcblx0XHRcdDAsIHMueSwgMCwgMCxcclxuXHRcdFx0MCwgMCwgcy56LCAwLFxyXG5cdFx0XHQwLCAwLCAwLCAxXHJcblx0XHQpKVxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBzdGF0aWMgZG90NChsaHM6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXJdLCByaHM6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXJdKSB7XHJcblx0XHRyZXR1cm4gbGhzWzBdICogcmhzWzBdICsgbGhzWzFdICogcmhzWzFdICsgbGhzWzJdICogcmhzWzJdICsgbGhzWzNdICogcmhzWzNdXHJcblx0fVxyXG59XHJcblxyXG5jb25zdCBpZGVudGl0eSA9IE9iamVjdC5mcmVlemUobWF0NChcclxuXHQxLCAwLCAwLCAwLFxyXG5cdDAsIDEsIDAsIDAsXHJcblx0MCwgMCwgMSwgMCxcclxuXHQwLCAwLCAwLCAxXHJcbikpXHJcblxyXG5jb25zdCB6ZXJvID0gT2JqZWN0LmZyZWV6ZShtYXQ0KFxyXG5cdDAsIDAsIDAsIDAsXHJcblx0MCwgMCwgMCwgMCxcclxuXHQwLCAwLCAwLCAwLFxyXG5cdDAsIDAsIDAsIDBcclxuKSlcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtYXQ0KC4uLnZhbHVlOiBudW1iZXJbXSk6IE1hdHJpeDR4NCB7XHJcblx0cmV0dXJuIG5ldyBNYXRyaXg0eDQoLi4udmFsdWUpXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IE1hdHJpeDR4NCJdfQ==